'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_nodeHid=require('node-hid'),_colorMap=require('./colorMap'),_colorMap2=_interopRequireDefault(_colorMap);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var NIL=0,Luxafor=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:62322,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1240;_classCallCheck(this,a),this.pid=b,this.vid=c,this.commands={color:1,fade:2,strobe:3,wave:4,pattern:6},this.positions={1:1,2:2,3:3,4:4,5:5,6:6,both:255,back:66,front:65},this.patterns={police:5},this.data={},this.ledPositions=[],this.device=new _nodeHid.HID(c,b)}return _createClass(a,[{key:'reset',value:function reset(){return this.data={},this.ledPositions=[],this}},{key:'getTiming',value:function getTiming(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return{color:[NIL,NIL,NIL],fade:[b,NIL,NIL],strobe:[b,NIL,c],wave:[NIL,c,b],pattern:[NIL,NIL,NIL]}[a]}},{key:'write',value:function write(a){var c=a.command,d=void 0===c?'color':c,e=a.position,f=void 0===e?'both':e,h=a.r,i=void 0===h?0:h,j=a.g,k=void 0===j?0:j,g=a.b,l=void 0===g?0:g,b=a.pattern,m=a.speed,n=a.repeat,o=this.patterns[b]||this.positions[f],p=[this.commands[d],o,i,k,l],q=this.getTiming(d,m,n);return this.device.write([].concat(p,_toConsumableArray(q))),this}},{key:'exec',value:function exec(){var a=this;return this.ledPositions.length?(this.ledPositions.forEach(function(b){return a.write(_extends({},a.data,{position:b}))}),this.reset()):this.write(this.data).reset()}},{key:'command',value:function command(a){return this.data.command=a,this}},{key:'color',value:function color(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return Object.assign(this.data,{r:a,g:c,b:d}),this}},{key:'fade',value:function fade(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:100;return Object.assign(this.data,{r:a,g:c,b:d,speed:e,command:'fade'}),this}},{key:'colorName',value:function colorName(a){return Object.assign(this.data,_colorMap2.default[a]),this}},{key:'led',value:function led(a){return this.data.position=a,this}},{key:'leds',value:function leds(a){return this.ledPositions=a,this}},{key:'pattern',value:function pattern(a){return this.data.pattern=a,this.data.command='pattern',this}}]),a}();exports.default=Luxafor,module.exports=exports['default'];